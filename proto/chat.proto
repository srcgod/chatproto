

syntax = "proto3";

package chatserv;

import "google/protobuf/field_mask.proto";
import "google/protobuf/timestamp.proto";
import "validate/validate.proto";

option go_package = "oneway/chat/v1;chatv1";

service ChatService {
  rpc GetMessages(GetMessagesRequest) returns (GetMessagesResponse);
}

message Chat {
  string id = 1 ;
  string name = 2 [ (validate.rules).string = {min_len : 3, max_len : 50} ];
  repeated string user_ids = 3;
}

message Message {
  int64 id = 1 [ (validate.rules).int64 = {gt : 0} ];
  string content = 2 [ (validate.rules).string = {min_len : 3, max_len : 50} ];
  int64 sender_id = 3 [ (validate.rules).int64 = {gt : 0} ];
  int64 receiver_id = 4 [ (validate.rules).int64 = {gt : 0} ];
  bytes chat_id = 5 [ (validate.rules).bytes = {len: 16} ]; // UUID as bytes (16 bytes)
  google.protobuf.Timestamp timestamp = 6;
}

message GetMessagesRequest {
  bytes chat_id = 1 [ (validate.rules).bytes = {len: 16} ]; // UUID as bytes (16 bytes)
  int32 page = 2 [ (validate.rules).int32 = {gt : 0} ];
  int32 page_size = 3 [ (validate.rules).int32 = {gt : 0} ];
}

message GetMessagesResponse {
  repeated Message messages = 1;
}


